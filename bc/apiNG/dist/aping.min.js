
/*! aping 30-11-2015 */
"use strict";var apingApp=angular.module("jtt_aping",[]).directive("aping",["apingDefaultSettings","apingUtilityHelper",function(a,b){return{restrict:"E",replace:"false",scope:{type:"@",items:"@",maxItems:"@",orderBy:"@",orderReverse:"@"},controller:["$scope",function(c){c.results=[],this.getAppSettings=function(){return{type:c.type||a.type,items:c.items||a.items,maxItems:c.maxItems||a.maxItems,orderBy:c.orderBy||a.orderBy,orderReverse:c.orderReverse||a.orderReverse}},this.concatToResults=function(a){c.results=c.results.concat(a),this.getAppSettings().orderBy&&(c.results.sort(b.sortArrayByProperty(this.getAppSettings().orderBy)),(this.getAppSettings().orderReverse===!0||"true"==this.getAppSettings().orderReverse)&&c.results.reverse()),this.getAppSettings().maxItems>0&&c.results.length>this.getAppSettings().maxItems&&(c.results=c.results.splice(0,this.getAppSettings().maxItems)),c.$broadcast("resultMerged")},this.apply=function(){c.$apply()}}],templateUrl:function(b,c){return c.templateUrl||a.templateUrl}}}]);apingApp.service("apingTimeHelper",function(){this.getTimestampFromDateString=function(a,b,c){if((!b||isNaN(b))&&(b=1),(!c||isNaN(c))&&(c=0),a){var d=a.split(/[^0-9]/);try{return parseInt(Math.round(new Date(d[0],d[1]-1,d[2],d[3],d[4],d[5])/1e3*b)+c)}catch(e){}}return!1},this.getConvertedTimestamp=function(a){var b,c=new Date(1e3*a),d=c.getFullYear(),e=("0"+(c.getMonth()+1)).slice(-2),f=("0"+c.getDate()).slice(-2),g=c.getHours(),h=g,i=("0"+c.getMinutes()).slice(-2),j="AM";return g>12?(h=g-12,j="PM"):12===g?(h=12,j="PM"):0==g&&(h=12),b=d+"-"+e+"-"+f+", "+h+":"+i+" "+j}}).service("apingUtilityHelper",["apingInputObjects",function(a){this.parseJsonFromAttributes=function(b,c,d){if("string"!=typeof b||!b)return[];var e=[],f=$.parseJSON(b.replace(/'/g,'"'));return angular.forEach(f,function(b,f){b.platform=c,"undefined"==typeof b.items&&d&&"undefined"!=typeof d.items&&(b.items=d.items);var g=a.getNew("request",b);e.push(g)}),e},this.getYoutubeIdFromUrl=function(a){var b=/^.*(?:(?:youtu\.be\/|v\/|vi\/|u\/\w\/|embed\/)|(?:(?:watch)?\?v(?:i)?=|\&v(?:i)?=))([^#\&\?]*).*/;return a.match(b)[1]||!1},this.getYoutubeImageFromId=function(a,b){switch(b){case"default":case"maxresdefault":case"mqdefault":case"sddefault":return"https://img.youtube.com/vi/"+a+"/"+b+".jpg";case"hqdefault":default:return"https://img.youtube.com/vi/"+a+"/hqdefault.jpg"}return!1},this.sortArrayByProperty=function(a){var b=1;return"-"===a[0]&&(b=-1,a=a.substr(1)),function(c,d){var e=c[a]<d[a]?-1:c[a]>d[a]?1:0;return e*b}}}]),apingApp.service("apingInputObjects",["apingDefaultSettings",function(a){this.getNew=function(b,c){var d={};switch(b){case"request":d=$.extend(!0,{type:a.type,items:a.items},c)}return d}}]),apingApp.service("apingModels",[function(){this.getNew=function(a,b){var c={};switch(a){case"social":c={platform:b,blog_name:!1,blog_id:!1,blog_link:!1,type:!1,timestamp:!1,post_url:!1,intern_id:!1,text:!1,caption:!1,img_url:!1,source:!1,likes:!1,shares:!1,comments:!1,position:!1};break;case"video":c={platform:b,blog_name:!1,blog_id:!1,blog_link:!1,timestamp:!1,post_url:!1,intern_id:!1,text:!1,caption:!1,img_url:!1,source:!1,markup:!1,likes:!1,shares:!1,comments:!1,position:!1};break;case"image":c={platform:b,blog_name:!1,blog_id:!1,blog_link:!1,timestamp:!1,post_url:!1,intern_id:!1,text:!1,caption:!1,img_url:!1,source:!1,likes:!1,shares:!1,comments:!1,position:!1};break;case"event":c={platform:b,blog_name:!1,blog_id:!1,blog_link:!1,start_timestamp:!1,end_timestamp:!1,event_url:!1,ticket_url:!1,intern_id:!1,text:!1,caption:!1,img_url:!1,place_name:!1,city:!1,country:!1,latitude:!1,longitude:!1,street:!1,zip:!1,source:!1}}return c}}]),apingApp.directive("imagesLoaded",["$timeout","$rootScope","$q",function(a,b,c){function d(b){a(b,0)}function e(a,b,c){this.loaded=void 0,this.loading=!0,c?this.__onload(b,!0):(this.node=new Image,this.bind(b),this.node.src=a)}function f(a){this.imagesCount=0,this.imagesLoaded=0,this.imagesFailed=0,this.useProgressEvents=a}var g={},h={progress:["imagesLoaded.QUARTER","imagesLoaded.HALF","imagesLoaded.THREEQUARTERS","imagesLoaded.FULL"],successful:"imagesLoaded.SUCCESS",complete:"imagesLoaded.FAIL",always:"imagesLoaded.ALWAYS"};return e.prototype={constructor:e,bind:function(a){var b=this;this.node.addEventListener("load",function(){b.__onload(a,!0)},!1),this.node.addEventListener("error",function(){b.__onload(a,!1)},!1)},__onload:function(a,b){this.loaded=!0,this.loading=!1,b&&this.node&&delete this.node,a(b)}},f.prototype={constructor:f,whenImagesLoaded:function(a){function b(a){var b;a?l.imagesLoaded++:l.imagesFailed++,l.useProgressEvents&&(b=(l.imagesLoaded+l.imagesFailed)/Math.ceil(k/4))&&b%1===0&&4>b&&d(function(){j.notify(h.progress[b-1])}),l.imagesLoaded+l.imagesFailed===l.imagesCount&&d(function(){j.notify(h.progress[3]),j.resolve(l.imagesFailed>0?h.complete:h.success)})}function f(a){var c=a.src,d=g[c];d?d.loaded?b(!0):d.loading?d.bind(b):d.loaded===!1:a.complete&&a.naturalWidth>0?g[c]=new e(c,b,!0):g[c]=new e(c,b)}var i,j=c.defer(),k=a.length,l=this;this.imagesCount=k;for(var m=0;m<this.imagesCount;m++)i=a[m],f(i);return j.promise}},{restrict:"A",compile:function(a,b){return function(a,b,c){var e,g=(b[0].childNodes,"yes"===c.useProgressEvents),i=0,j=document.images;a.$watch(function(){return j.length},function(c,j){var k,l;c!==j&&(e=b.find("img"),k=e.length,k!==i&&(i=k,l=new f(g),d(function(){l.whenImagesLoaded(e).then(function(b){a.$emit(b),a.$emit(h.always)},function(a){},function(b){g&&a.$emit("imagesLoaded.PROGRESS",{status:b})})})))})}}}}]);