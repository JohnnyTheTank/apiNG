
/*! aping v0.1.0 (12-12-2015) by Jonathan Hornung */
"use strict";var apingApp=angular.module("jtt_aping",[]).directive("aping",["apingDefaultSettings","apingUtilityHelper",function(a,b){return{restrict:"E",replace:"false",scope:{model:"@",items:"@",maxItems:"@",orderBy:"@",orderReverse:"@",templateUrl:"@",payloadJson:"@"},controller:["$scope",function(c){c.results=[],c.payload=c.payloadJson?b.replaceSingleQuotesAndParseJson(c.payloadJson):{},this.getAppSettings=function(){return{model:c.model||a.model||"custom",items:c.items||a.items,maxItems:c.maxItems||a.maxItems,orderBy:c.orderBy||a.orderBy,orderReverse:c.orderReverse||a.orderReverse}},this.concatToResults=function(a){c.results=c.results.concat(a);var d=this.getAppSettings();d.orderBy&&"$NONE"!=d.orderBy&&("$RANDOM"==d.orderBy?c.results=b.shuffleArray(c.results):(c.results.sort(b.sortArrayByProperty(d.orderBy)),(d.orderReverse===!0||"true"===d.orderReverse)&&c.results.reverse())),d.maxItems>-1&&c.results.length>d.maxItems&&(c.results=c.results.splice(0,d.maxItems)),c.$broadcast("apiNG.resultMerged")},this.apply=function(){c.$apply()}}],templateUrl:function(b,c){return c.templateUrl||a.templateUrl}}}]);apingApp.service("apingTimeHelper",function(){this.getTimestampFromDateString=function(a,b,c){if((!b||isNaN(b))&&(b=1),(!c||isNaN(c))&&(c=0),a){var d=a.split(/[^0-9]/);try{return parseInt(Math.round(new Date(d[0],d[1]-1,d[2],d[3],d[4],d[5])/1e3*b)+c)}catch(e){}}return!1}}).service("apingUtilityHelper",["apingInputObjects","apingApiKeys",function(a,b){this.getApiCredentials=function(a,c){return b&&b[a]?b[a][Math.floor(Math.random()*b[a].length)][c]:!1},this.parseJsonFromAttributes=function(b,c,d){if("string"!=typeof b||!b)return[];var e=[],f=this.replaceSingleQuotesAndParseJson(b);return angular.forEach(f,function(b,f){b.platform=c,d&&("undefined"==typeof b.items&&"undefined"!=typeof d.items&&(b.items=d.items),"undefined"==typeof b.model&&"undefined"!=typeof d.model&&(b.model=d.model));var g=a.getNew("request",b);e.push(g)}),e},this.replaceSingleQuotesAndParseJson=function(a){return $.parseJSON(a.replace(/'/g,'"'))},this.sortArrayByProperty=function(a){var b=1;return"-"===a[0]&&(b=-1,a=a.substr(1)),function(c,d){var e=c[a]<d[a]?-1:c[a]>d[a]?1:0;return e*b}},this.shuffleArray=function(a){for(var b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}return a}}]),apingApp.service("apingInputObjects",["apingDefaultSettings",function(a){this.getNew=function(b,c){var d={};switch(b){case"request":d=$.extend(!0,{model:a.model,items:a.items},c)}return d}}]),apingApp.service("apingModels",[function(){this.getNew=function(a,b){var c={};switch(a){case"social":c={platform:b,blog_name:!1,blog_id:!1,blog_link:!1,type:!1,timestamp:!1,date_time:!1,post_url:!1,intern_id:!1,text:!1,caption:!1,img_url:!1,source:!1,likes:!1,shares:!1,comments:!1,position:!1};break;case"video":c={platform:b,blog_name:!1,blog_id:!1,blog_link:!1,timestamp:!1,date_time:!1,post_url:!1,intern_id:!1,text:!1,caption:!1,img_url:!1,source:!1,markup:!1,likes:!1,shares:!1,comments:!1,position:!1};break;case"image":c={platform:b,blog_name:!1,blog_id:!1,blog_link:!1,timestamp:!1,date_time:!1,post_url:!1,intern_id:!1,text:!1,caption:!1,img_url:!1,source:!1,likes:!1,shares:!1,comments:!1,position:!1};break;case"event":c={platform:b,blog_name:!1,blog_id:!1,blog_link:!1,start_timestamp:!1,start_date_time:!1,end_timestamp:!1,end_date_time:!1,event_url:!1,ticket_url:!1,intern_id:!1,text:!1,caption:!1,img_url:!1,place_name:!1,city:!1,country:!1,latitude:!1,longitude:!1,street:!1,zip:!1,source:!1};break;case"repo":c={platform:b,owner_name:!1,owner_id:!1,owner_link:!1,owner_img_url:!1,name:!1,id:!1,fullname:!1,description:!1,url:!1,homepage:!1,language:!1,clone_url:!1,git_url:!1,ssh_url:!1,svn_url:!1,isFork:!1,openIssues:!1,watchers:!1,stargazers:!1,forks:!1,created_timestamp:!1,created_date_time:!1,updated_timestamp:!1,updated_date_time:!1,pushed_timestamp:!1,pushed_date_time:!1};break;case"activity":c={platform:b,body:!1,actor_name:!1,actor_id:!1,actor_url:!1,actor_img_url:!1,actor_type:!1,action_name:!1,action_message:!1,action_id:!1,action_url:!1,action_img:!1,action_type:!1,object_name:!1,object_id:!1,object_img:!1,object_url:!1,object_type:!1,context:!1,timestamp:!1,date_time:!1}}return c}}]),apingApp.directive("imagesLoaded",["$timeout","$rootScope","$q",function(a,b,c){function d(b){a(b,0)}function e(a,b,c){this.loaded=void 0,this.loading=!0,c?this.__onload(b,!0):(this.node=new Image,this.bind(b),this.node.src=a)}function f(a){this.imagesCount=0,this.imagesLoaded=0,this.imagesFailed=0,this.useProgressEvents=a}var g={},h={progress:["imagesLoaded.QUARTER","imagesLoaded.HALF","imagesLoaded.THREEQUARTERS","imagesLoaded.FULL"],successful:"imagesLoaded.SUCCESS",complete:"imagesLoaded.FAIL",always:"imagesLoaded.ALWAYS"};return e.prototype={constructor:e,bind:function(a){var b=this;this.node.addEventListener("load",function(){b.__onload(a,!0)},!1),this.node.addEventListener("error",function(){b.__onload(a,!1)},!1)},__onload:function(a,b){this.loaded=!0,this.loading=!1,b&&this.node&&delete this.node,a(b)}},f.prototype={constructor:f,whenImagesLoaded:function(a){function b(a){var b;a?l.imagesLoaded++:l.imagesFailed++,l.useProgressEvents&&(b=(l.imagesLoaded+l.imagesFailed)/Math.ceil(k/4))&&b%1===0&&4>b&&d(function(){j.notify(h.progress[b-1])}),l.imagesLoaded+l.imagesFailed===l.imagesCount&&d(function(){j.notify(h.progress[3]),j.resolve(l.imagesFailed>0?h.complete:h.success)})}function f(a){var c=a.src,d=g[c];d?d.loaded?b(!0):d.loading?d.bind(b):d.loaded===!1:a.complete&&a.naturalWidth>0?g[c]=new e(c,b,!0):g[c]=new e(c,b)}var i,j=c.defer(),k=a.length,l=this;this.imagesCount=k;for(var m=0;m<this.imagesCount;m++)i=a[m],f(i);return j.promise}},{restrict:"A",compile:function(a,b){return function(a,b,c){var e,g=(b[0].childNodes,"yes"===c.useProgressEvents),i=0,j=document.images;a.$watch(function(){return j.length},function(c,j){var k,l;c!==j&&(e=b.find("img"),k=e.length,k!==i&&(i=k,l=new f(g),d(function(){l.whenImagesLoaded(e).then(function(b){a.$emit(b),a.$emit(h.always)},function(a){},function(b){g&&a.$emit("imagesLoaded.PROGRESS",{status:b})})})))})}}}}]);